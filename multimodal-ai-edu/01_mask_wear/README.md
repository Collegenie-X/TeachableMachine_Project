# 마스크 착용 인식 프로젝트

실시간 카메라를 통해 마스크 착용 여부를 감지하고, 올바른 마스크 착용 방법을 안내하는 시스템입니다.

## 폴더 구조 및 파일 설명

```
01_mask_wear/
│
├── data/                  # 학습 및 테스트용 데이터셋
│   ├── mask/              # 마스크 착용 이미지들
│   └── no_mask/           # 마스크 미착용 이미지들
│
├── models/                # 학습된 모델 파일 저장 디렉토리
│   ├── model.h5           # TensorFlow/Keras 모델 파일
│   └── labels.txt         # 클래스 레이블 정보
│
├── src/                   # 소스 코드 디렉토리
│   ├── mask_detection_app.py      # 마스크 인식 애플리케이션 메인 파일
│   ├── utils/                     # 유틸리티 함수 모듈
│   │   ├── __init__.py            # 패키지 초기화 파일
│   │   ├── image_processing.py    # 이미지 전처리 유틸리티
│   │   └── model_utils.py         # 모델 로딩 및 예측 유틸리티
│   └── config.py                  # 설정 파일
│
└── README.md              # 프로젝트 설명 문서
```

## 주요 기능

1. **실시간 마스크 착용 감지**
   - 웹캠을 통해 실시간으로 사용자의 마스크 착용 여부를 감지
   - 높은 정확도로 마스크 착용/미착용 상태 분류

2. **시각적 피드백 제공**
   - 마스크 착용 시 녹색 프레임, 미착용 시 빨간색 프레임으로 시각적 표시
   - 인식 결과 및 확률을 화면에 실시간으로 표시

3. **경고 시스템**
   - 마스크 미착용 감지 시 경고 메시지 표시
   - 지속적인 미착용 시 더 강한 경고 메시지 표시

4. **사용 통계 수집**
   - 마스크 착용/미착용 시간 통계 수집
   - 사용 패턴 분석을 통한 개선점 도출 가능

## 실행 방법

### 1. 필요한 라이브러리 설치

```bash
pip install -r requirements.txt
```

### 2. 실행하기

#### 방법 1: 직접 Python 스크립트 실행

```bash
cd src
python mask_detection_app.py
```

#### 방법 2: 명령줄 옵션 사용

```bash
cd src
python mask_detection_app.py --model ../models/model.h5 --labels ../models/labels.txt --camera 0
```

**명령줄 옵션:**
- `--model`: 모델 파일 경로 (기본값: ../models/model.h5)
- `--labels`: 라벨 파일 경로 (기본값: ../models/labels.txt)
- `--camera`: 카메라 장치 번호 (기본값: 0)
- `--image_size`: 입력 이미지 크기 (기본값: 96)

### 3. 사용 방법

- 프로그램이 실행되면 카메라가 활성화됩니다.
- 카메라 앞에서 마스크 착용/미착용 상태를 보여주세요.
- 실시간으로 화면에 감지 결과가 표시됩니다.
- 'q' 키를 누르면 프로그램이 종료됩니다.

## 기술 상세

### 이미지 전처리 (image_processing.py)
- 이미지 크기 조정: 모델 입력에 맞게 96x96 크기로 조정
- 정규화: 픽셀값을 0~1 사이로 정규화하여 모델 성능 향상
- 채널 변환: RGB 채널 순서 조정(TensorFlow 입력 형식에 맞춤)

### 모델 유틸리티 (model_utils.py)
- 모델 로딩: TensorFlow/Keras 모델(.h5) 파일 로드
- 예측 처리: 이미지 입력에 대한 예측 수행 및 결과 반환
- 레이블 매핑: 예측 인덱스를 사람이 읽을 수 있는 레이블로 변환

### 애플리케이션 메인 (mask_detection_app.py)
- 카메라 인터페이스: OpenCV를 사용한 실시간 카메라 스트림 처리
- UI 렌더링: 인식 결과 및 경고 메시지 화면 표시
- 이벤트 처리: 키보드 입력 감지 및 프로그램 제어

## 성능 향상 팁

1. 더 많은 데이터로 모델 재학습
   ```bash
   # 추가 데이터를 data/ 폴더에 넣은 후 모델 재학습
   cd src
   python train_model.py --data_dir ../data --epochs 20
   ```

2. 다양한 조명 환경에서 테스트하여 모델 강건성 향상
3. 더 큰 이미지 크기 사용으로 정확도 향상 가능 (단, 처리 속도 저하 발생 가능)

## 문제 해결

- **카메라 접근 오류**: 카메라 장치 번호(--camera 옵션)를 변경해보세요.
- **모델 로딩 오류**: 모델 파일 경로가 올바른지 확인하세요.
- **낮은 인식률**: 다양한 조명 조건에서 데이터를 추가하여 모델을 재학습하세요.
- **느린 처리 속도**: 이미지 크기를 줄이거나 더 강력한 하드웨어에서 실행하세요. 